# ğŸ¯ ç®€åŒ–æµ‹è¯•éªŒè¯æ–¹æ¡ˆ

## ğŸš€ å¿«é€Ÿæµ‹è¯•ä¿®å¤æ•ˆæœ

ç”±äºå®Œæ•´çš„é‚€è¯·æµç¨‹å¯èƒ½éœ€è¦å¤šä¸ªè´¦å·ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡ç®€åŒ–çš„æ–¹å¼éªŒè¯ä¿®å¤æ˜¯å¦ç”Ÿæ•ˆã€‚

### ğŸ“± æ–¹æ¡ˆ1ï¼šå•è´¦å·æµ‹è¯•

#### æ­¥éª¤1ï¼šå®Œæˆç™»å½•å¹¶åˆ›å»ºèŠå¤©
1. **æ‰“å¼€å°ç¨‹åºï¼Œå®Œæˆç™»å½•**
2. **è¿›å…¥èŠå¤©é¡µé¢**ï¼ˆå¯ä»¥ç›´æ¥åœ¨åœ°å€æ è¾“å…¥æµ‹è¯•URLï¼‰
3. **éªŒè¯åŸºç¡€åŠŸèƒ½æ˜¯å¦æ­£å¸¸**

#### æ­¥éª¤2ï¼šæ‰‹åŠ¨éªŒè¯ä¿®å¤é¡¹

**åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°ä¸­è¿è¡Œä»¥ä¸‹ä»£ç ï¼š**

```javascript
// 1. éªŒè¯ç”¨æˆ·ä¿¡æ¯å’Œå¤´åƒ
console.log('=== ç”¨æˆ·ä¿¡æ¯æ£€æŸ¥ ===');
console.log('ç”¨æˆ·ä¿¡æ¯:', getApp().globalData.userInfo);
console.log('å¤´åƒURL:', getApp().globalData.userInfo?.avatarUrl);

// 2. æ‰‹åŠ¨æµ‹è¯•ç³»ç»Ÿæ¶ˆæ¯æ ·å¼
console.log('=== ç³»ç»Ÿæ¶ˆæ¯æµ‹è¯• ===');
// å‡è®¾å½“å‰åœ¨èŠå¤©é¡µé¢ï¼Œä½¿ç”¨ getCurrentPages() è·å–é¡µé¢å®ä¾‹
const currentPage = getCurrentPages()[getCurrentPages().length - 1];
if (currentPage && currentPage.addSystemMessage) {
  currentPage.addSystemMessage('âœ¨ æµ‹è¯•ç³»ç»Ÿæ¶ˆæ¯æ ·å¼ - åº”è¯¥æ˜¾ç¤ºä¸ºç°è‰²å±…ä¸­æ°”æ³¡');
}

// 3. æ‰‹åŠ¨æµ‹è¯•æ˜µç§°æ˜¾ç¤º
console.log('=== æ˜µç§°æ˜¾ç¤ºæµ‹è¯• ===');
if (currentPage && currentPage.setData) {
  currentPage.setData({
    dynamicTitle: 'æˆ‘å’Œæµ‹è¯•æœ‹å‹ï¼ˆ2ï¼‰',
    participants: [
      {
        id: 'user1',
        nickName: getApp().globalData.userInfo?.nickName || 'æˆ‘',
        avatarUrl: getApp().globalData.userInfo?.avatarUrl || '/assets/images/default-avatar.png',
        isSelf: true
      },
      {
        id: 'user2', 
        nickName: 'æµ‹è¯•æœ‹å‹',
        avatarUrl: '/assets/images/default-avatar.png',
        isSelf: false
      }
    ]
  });
}

// 4. æ‰‹åŠ¨æµ‹è¯•å¤´åƒæ˜¾ç¤º
console.log('=== å¤´åƒæ˜¾ç¤ºæµ‹è¯• ===');
if (currentPage && currentPage.sendMessage) {
  // æ¨¡æ‹Ÿå‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œæµ‹è¯•å¤´åƒæ˜¾ç¤º
  currentPage.setData({ inputValue: 'æµ‹è¯•æ¶ˆæ¯ï¼ŒéªŒè¯å¤´åƒæ˜¾ç¤º' });
  // æ³¨æ„ï¼šå®é™…å‘é€éœ€è¦æœ‰æ•ˆçš„èŠå¤©ç¯å¢ƒ
}
```

#### æ­¥éª¤3ï¼šéªŒè¯æ•ˆæœ

è¿è¡Œä¸Šè¿°ä»£ç åï¼Œæ£€æŸ¥é¡µé¢æ˜¯å¦æ˜¾ç¤ºï¼š

âœ… **ç³»ç»Ÿæ¶ˆæ¯**ï¼šç°è‰²å±…ä¸­æ°”æ³¡ï¼Œæ–‡å­—ä¸ºç°è‰²  
âœ… **æ ‡é¢˜æ˜¾ç¤º**ï¼šæ˜¾ç¤ºä¸º"æˆ‘å’Œæµ‹è¯•æœ‹å‹ï¼ˆ2ï¼‰"  
âœ… **ç”¨æˆ·å¤´åƒ**ï¼šæ§åˆ¶å°è¾“å‡ºæœ‰æ•ˆçš„å¤´åƒURL  

---

### ğŸ“± æ–¹æ¡ˆ2ï¼šç›´æ¥æµ‹è¯•URL

å¦‚æœæ‚¨æƒ³æµ‹è¯•å®Œæ•´æµç¨‹ï¼Œå¯ä»¥æ‰‹åŠ¨æ„é€ æµ‹è¯•URLï¼š

#### å‘é€æ–¹æµ‹è¯•URL
```
/app/pages/chat/chat?id=test_chat_123&isNewChat=true&userName=æµ‹è¯•å‘é€æ–¹
```

#### æ¥æ”¶æ–¹æµ‹è¯•URL  
```
/app/pages/chat/chat?id=chat_1749373080852_t0j4aiqir&inviter=å‘å†¬&fromInvite=true
```

**åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ï¼š**
1. æ‰“å¼€ **æ¨¡æ‹Ÿå™¨** - **è‡ªå®šä¹‰ç¼–è¯‘**
2. è¾“å…¥ä¸Šè¿°URLè¿›è¡Œæµ‹è¯•
3. éªŒè¯ä¸åŒè§’è‰²çš„æ˜¾ç¤ºæ•ˆæœ

---

### ğŸ” éªŒè¯æ£€æŸ¥æ¸…å•

#### âœ… ç³»ç»Ÿæ¶ˆæ¯æ ·å¼éªŒè¯
- [ ] ç³»ç»Ÿæ¶ˆæ¯æ˜¾ç¤ºä¸ºç°è‰²æ°”æ³¡
- [ ] ç³»ç»Ÿæ¶ˆæ¯å±…ä¸­æ˜¾ç¤º
- [ ] æ–‡å­—é¢œè‰²ä¸ºç°è‰² (#888888)
- [ ] èƒŒæ™¯è‰²ä¸ºåŠé€æ˜ç°è‰² (rgba(0,0,0,0.1))

#### âœ… æ˜µç§°æ˜¾ç¤ºéªŒè¯
- [ ] å‘é€æ–¹æ ‡é¢˜æ˜¾ç¤ºæ­£ç¡®
- [ ] æ¥æ”¶æ–¹æ ‡é¢˜æ˜¾ç¤º"æˆ‘å’Œ[å‘é€æ–¹æ˜µç§°]ï¼ˆ2ï¼‰"
- [ ] æ˜µç§°æ­£ç¡®è§£ç ï¼ˆæ²¡æœ‰ç¼–ç å­—ç¬¦ï¼‰

#### âœ… å¤´åƒæ˜¾ç¤ºéªŒè¯
- [ ] æ§åˆ¶å°èƒ½çœ‹åˆ°æœ‰æ•ˆçš„å¤´åƒURL
- [ ] å¤´åƒåœ¨æ¶ˆæ¯ä¸­æ­£ç¡®æ˜¾ç¤º
- [ ] å‘é€æ–¹å’Œæ¥æ”¶æ–¹å¤´åƒéƒ½æ˜¾ç¤º

---

### ğŸ› ï¸ å¦‚æœæµ‹è¯•å¤±è´¥çš„å¿«é€Ÿä¿®å¤

#### é—®é¢˜1ï¼šç³»ç»Ÿæ¶ˆæ¯æ ·å¼ä¸æ­£ç¡®
**æ£€æŸ¥WXMLç»“æ„**ï¼Œç¡®ä¿åŒ…å«ï¼š
```xml
<view wx:if="{{item.isSystem}}" class="message-wrapper system">
  <view class="system-message">
    <text class="message-text">{{item.content}}</text>
  </view>
</view>
```

#### é—®é¢˜2ï¼šæ˜µç§°æ˜¾ç¤ºä¸æ­£ç¡®
**æ‰‹åŠ¨è®¾ç½®æ ‡é¢˜**ï¼š
```javascript
const page = getCurrentPages()[getCurrentPages().length - 1];
page.setData({ dynamicTitle: 'æˆ‘å’Œæœ‹å‹æ˜µç§°ï¼ˆ2ï¼‰' });
```

#### é—®é¢˜3ï¼šå¤´åƒä¸æ˜¾ç¤º
**æ£€æŸ¥å¤´åƒURL**ï¼š
```javascript
console.log('å¤´åƒæ£€æŸ¥:', getApp().globalData.userInfo?.avatarUrl);
// å¦‚æœä¸ºç©ºï¼Œå¯èƒ½éœ€è¦é‡æ–°ç™»å½•è·å–å¤´åƒæˆæƒ
```

---

### ğŸ¯ é¢„æœŸæµ‹è¯•ç»“æœ

å¦‚æœä¿®å¤æˆåŠŸï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ï¼š

#### ğŸ“¸ ç³»ç»Ÿæ¶ˆæ¯æ•ˆæœ
```
    [  ç³»ç»Ÿæ¶ˆæ¯æµ‹è¯•  ]   <- ç°è‰²å±…ä¸­æ°”æ³¡
```

#### ğŸ“¸ æ ‡é¢˜æ•ˆæœ
```
æ ‡é¢˜æ : æˆ‘å’Œæµ‹è¯•æœ‹å‹ï¼ˆ2ï¼‰
```

#### ğŸ“¸ æ¶ˆæ¯å¤´åƒæ•ˆæœ
```
[å¤´åƒ] æ¶ˆæ¯å†…å®¹...    <- å‘é€æ–¹æ¶ˆæ¯ï¼ˆå³ä¾§ï¼‰
    æ¶ˆæ¯å†…å®¹... [å¤´åƒ] <- æ¥æ”¶æ–¹æ¶ˆæ¯ï¼ˆå·¦ä¾§ï¼‰
```

---

### ğŸ”§ è°ƒè¯•å‘½ä»¤é€ŸæŸ¥

å¦‚æœéœ€è¦æ·±å…¥è°ƒè¯•ï¼Œä½¿ç”¨è¿™äº›æ§åˆ¶å°å‘½ä»¤ï¼š

```javascript
// æŸ¥çœ‹é¡µé¢å®Œæ•´æ•°æ®
console.log('é¡µé¢æ•°æ®:', getCurrentPages()[getCurrentPages().length - 1].data);

// æŸ¥çœ‹æ¶ˆæ¯åˆ—è¡¨
console.log('æ¶ˆæ¯åˆ—è¡¨:', getCurrentPages()[getCurrentPages().length - 1].data.messages);

// æŸ¥çœ‹å‚ä¸è€…ä¿¡æ¯
console.log('å‚ä¸è€…:', getCurrentPages()[getCurrentPages().length - 1].data.participants);

// æŸ¥çœ‹å½“å‰ç”¨æˆ·ä¿¡æ¯
console.log('å½“å‰ç”¨æˆ·:', getCurrentPages()[getCurrentPages().length - 1].data.currentUser);
```

---

## ğŸ‰ æˆåŠŸæ ‡å‡†

æµ‹è¯•æˆåŠŸçš„æ ‡å¿—ï¼š

1. âœ… **ç³»ç»Ÿæ¶ˆæ¯**æ˜¾ç¤ºä¸ºç°è‰²å±…ä¸­æ°”æ³¡
2. âœ… **æ ‡é¢˜**æ­£ç¡®æ˜¾ç¤ºæ˜µç§°åŒ¹é…
3. âœ… **å¤´åƒ**èƒ½æ­£ç¡®è·å–å’Œæ˜¾ç¤º
4. âœ… **æ§åˆ¶å°æ— é”™è¯¯**æˆ–å…³é”®åŠŸèƒ½é”™è¯¯

å¦‚æœè¿™äº›åŸºç¡€åŠŸèƒ½éƒ½æ­£å¸¸ï¼Œè¯´æ˜ä¿®å¤ç”Ÿæ•ˆäº†ï¼ç„¶åå°±å¯ä»¥è¿›è¡Œå®Œæ•´çš„åŒè´¦å·é‚€è¯·æµç¨‹æµ‹è¯•ã€‚

è¯·å…ˆæŒ‰è¿™ä¸ªç®€åŒ–æ–¹æ¡ˆæµ‹è¯•ï¼Œå¦‚æœæœ‰ä»»ä½•æ­¥éª¤å¤±è´¥ï¼Œè¯·å‘Šè¯‰æˆ‘å…·ä½“æ˜¯å“ªä¸€æ­¥ï¼Œæˆ‘ä¼šæä¾›é’ˆå¯¹æ€§çš„è§£å†³æ–¹æ¡ˆï¼ ğŸš€ 