# 秘信小程序云开发设置指南

## 一、部署云函数

1. 打开微信开发者工具，加载秘信小程序项目
2. 点击工具栏中的"云开发"按钮，进入云开发控制台
3. 确保已经创建并选择了云环境 `ququer-env-6g35f0nv28c446e7`
4. 部署两个新的云函数:

### 部署 createInvite 云函数

1. 在微信开发者工具左侧目录中，右键点击 `cloudfunctions/createInvite` 文件夹
2. 选择"上传并部署：云端安装依赖（不上传node_modules）"
3. 等待部署完成，确认控制台中显示"上传成功"

### 部署 joinByInvite 云函数

1. 在微信开发者工具左侧目录中，右键点击 `cloudfunctions/joinByInvite` 文件夹
2. 选择"上传并部署：云端安装依赖（不上传node_modules）"
3. 等待部署完成，确认控制台中显示"上传成功"

## 二、创建数据库集合

1. 在云开发控制台中点击左侧菜单的"数据库"
2. 点击页面上的"添加集合"按钮
3. 在弹出窗口中输入集合名称：`invites`
4. 点击"确定"按钮创建集合
5. 设置集合权限：
   - 点击新创建的invites集合右侧的"权限设置"
   - 选择"所有用户可读，仅创建者可写"
   - 点击"确定"保存设置

## 三、运行自动测试

完成上述设置后，在小程序中进行自动测试：

1. 编译并运行小程序
2. 确保已登录小程序
3. 在工具栏中点击"编译"按钮，或使用快捷键Ctrl+B (Windows) 或 Cmd+B (Mac)
4. 在小程序中点击右上角的"..."按钮
5. 选择"打开调试"
6. 在页面中输入路径：`/pages/test/test`
7. 点击"前往"按钮进入测试页面
8. 在测试页面中点击"开始自动测试"按钮
9. 观察测试日志，确认每个步骤是否成功
10. 测试完成后，可以点击"进入测试聊天"按钮验证聊天功能

## 四、查看测试数据

测试完成后，可以在云开发控制台中查看创建的数据：

1. 在云开发控制台中点击"数据库"
2. 查看`invites`集合中是否有新创建的邀请记录
3. 查看`conversations`集合中是否有新创建的会话记录
4. 查看`messages`集合中是否有相应的系统消息记录

如果所有步骤都成功完成，说明邀请链接匹配功能已正常工作。 