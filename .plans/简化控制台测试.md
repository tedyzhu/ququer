# ğŸ¯ ç®€åŒ–æ§åˆ¶å°æµ‹è¯•

## ğŸ“‹ é¿å…è¯­æ³•é”™è¯¯çš„æ§åˆ¶å°å‘½ä»¤

### æ–¹æ³•1ï¼šåˆ†æ­¥æ‰§è¡Œï¼ˆæ¨èï¼‰

**æ­¥éª¤1ï¼šæ£€æŸ¥é¡µé¢æ•°æ®**
```javascript
var currentPage = getCurrentPages()[getCurrentPages().length - 1];
console.log('èŠå¤©ID:', currentPage.data.contactId);
```

**æ­¥éª¤2ï¼šæ£€æŸ¥ç”¨æˆ·ä¿¡æ¯**
```javascript
var userInfo = getApp().globalData.userInfo;
console.log('ç”¨æˆ·æ˜µç§°:', userInfo.nickName);
console.log('ç”¨æˆ·å¤´åƒ:', userInfo.avatarUrl);
```

**æ­¥éª¤3ï¼šæ£€æŸ¥å‚ä¸è€…ä¿¡æ¯**
```javascript
var participants = currentPage.data.participants;
console.log('å‚ä¸è€…æ•°é‡:', participants.length);
console.log('å‚ä¸è€…åˆ—è¡¨:', participants);
```

**æ­¥éª¤4ï¼šæ£€æŸ¥æ¶ˆæ¯åˆ—è¡¨**
```javascript
var messages = currentPage.data.messages;
console.log('æ¶ˆæ¯æ•°é‡:', messages.length);
console.log('æœ€åä¸€æ¡æ¶ˆæ¯:', messages[messages.length - 1]);
```

**æ­¥éª¤5ï¼šæ£€æŸ¥ç³»ç»Ÿæ¶ˆæ¯**
```javascript
var systemMessages = messages.filter(function(msg) { return msg.isSystem; });
console.log('ç³»ç»Ÿæ¶ˆæ¯æ•°é‡:', systemMessages.length);
console.log('ç³»ç»Ÿæ¶ˆæ¯:', systemMessages);
```

### æ–¹æ³•2ï¼šæ‰‹åŠ¨æµ‹è¯•åŠŸèƒ½

**æ‰‹åŠ¨æ·»åŠ ç³»ç»Ÿæ¶ˆæ¯æµ‹è¯•**
```javascript
currentPage.addSystemMessage('ğŸ§ª æ‰‹åŠ¨æµ‹è¯•ç³»ç»Ÿæ¶ˆæ¯ - åº”æ˜¾ç¤ºä¸ºç°è‰²æ°”æ³¡');
```

**æ‰‹åŠ¨æ›´æ–°æ ‡é¢˜æµ‹è¯•**
```javascript
currentPage.setData({ dynamicTitle: 'æˆ‘å’Œå‘å†¬ï¼ˆ2ï¼‰æµ‹è¯•' });
```

**æ‰‹åŠ¨æ£€æŸ¥æ ‡é¢˜æ›´æ–°å‡½æ•°**
```javascript
currentPage.updateDynamicTitleWithRealNames();
```

## ğŸ” å½“å‰é—®é¢˜åˆ†æ

æ ¹æ®æœ€æ–°æ—¥å¿—ï¼Œé—®é¢˜å·²ç»åŸºæœ¬è§£å†³ï¼š

âœ… **å·²ä¿®å¤çš„åŠŸèƒ½ï¼š**
- æ¥æ”¶æ–¹æˆåŠŸåŠ å…¥èŠå¤©
- å‚ä¸è€…æ•°é‡æ­£ç¡®ï¼ˆ2äººï¼‰
- ç³»ç»Ÿæ¶ˆæ¯æ­£ç¡®æ·»åŠ ï¼š"æˆåŠŸåŠ å…¥å‘å†¬çš„èŠå¤©ï¼"
- å®æ—¶æ¶ˆæ¯ç›‘å¬æ­£å¸¸å·¥ä½œ

âŒ **éœ€è¦éªŒè¯çš„ä¿®å¤ï¼š**
- æ ‡é¢˜æ˜¯å¦æ˜¾ç¤º"æˆ‘å’Œå‘å†¬ï¼ˆ2ï¼‰"è€Œä¸æ˜¯"æˆ‘å’Œç”¨æˆ·ï¼ˆ2ï¼‰"
- ç³»ç»Ÿæ¶ˆæ¯æ˜¯å¦æ˜¾ç¤ºä¸ºç°è‰²å±…ä¸­æ°”æ³¡
- å¤´åƒæ˜¯å¦æ­£ç¡®æ˜¾ç¤º

## ğŸš€ éƒ¨ç½²å’Œæµ‹è¯•æ–°ä¿®å¤

### æ­¥éª¤1ï¼šé‡æ–°éƒ¨ç½²äº‘å‡½æ•°
éœ€è¦é‡æ–°éƒ¨ç½² `joinByInvite` äº‘å‡½æ•°ä»¥åº”ç”¨æ˜µç§°ä¿®å¤ã€‚

### æ­¥éª¤2ï¼šæµ‹è¯•æ–°çš„æ¥æ”¶æ–¹æµç¨‹
ä½¿ç”¨ç›¸åŒçš„æµ‹è¯•URLå†æ¬¡æµ‹è¯•ï¼š
```
/app/pages/chat/chat?id=chat_1749373388847_fdyipuryh&inviter=å‘å†¬&fromInvite=true
```

### æ­¥éª¤3ï¼šéªŒè¯ä¿®å¤æ•ˆæœ
è¿è¡Œç®€åŒ–çš„æ§åˆ¶å°å‘½ä»¤æ£€æŸ¥ï¼š

**æ£€æŸ¥æ ‡é¢˜æ˜¯å¦æ­£ç¡®ï¼š**
```javascript
console.log('å½“å‰æ ‡é¢˜:', getCurrentPages()[getCurrentPages().length - 1].data.dynamicTitle);
```

**æ£€æŸ¥å‚ä¸è€…æ˜µç§°ï¼š**
```javascript
var participants = getCurrentPages()[getCurrentPages().length - 1].data.participants;
participants.forEach(function(p, index) {
  console.log('å‚ä¸è€…' + index + ':', p.nickName, 'æ˜¯å¦è‡ªå·±:', p.isSelf);
});
```

## ğŸ‰ é¢„æœŸä¿®å¤æ•ˆæœ

ä¿®å¤ååº”è¯¥çœ‹åˆ°ï¼š

1. **æ ‡é¢˜æ˜¾ç¤ºï¼š** "æˆ‘å’Œå‘å†¬ï¼ˆ2ï¼‰"
2. **å‚ä¸è€…ä¿¡æ¯ï¼š** 
   - å‚ä¸è€…0: "å‘å†¬" æ˜¯å¦è‡ªå·±: false
   - å‚ä¸è€…1: "å‘å†¬" æ˜¯å¦è‡ªå·±: true
3. **ç³»ç»Ÿæ¶ˆæ¯ï¼š** ç°è‰²å±…ä¸­æ°”æ³¡æ˜¾ç¤º"æˆåŠŸåŠ å…¥å‘å†¬çš„èŠå¤©ï¼"

## ğŸ“ æµ‹è¯•æ¸…å•

è¯·æŒ‰é¡ºåºæ‰§è¡Œï¼š

1. [ ] é‡æ–°éƒ¨ç½² `joinByInvite` äº‘å‡½æ•°
2. [ ] é‡æ–°æµ‹è¯•æ¥æ”¶æ–¹åŠ å…¥æµç¨‹
3. [ ] è¿è¡Œç®€åŒ–æ§åˆ¶å°å‘½ä»¤éªŒè¯
4. [ ] æ£€æŸ¥æ ‡é¢˜ã€å‚ä¸è€…ã€ç³»ç»Ÿæ¶ˆæ¯æ˜¯å¦æ­£ç¡®

å¦‚æœä»æœ‰é—®é¢˜ï¼Œè¯·æä¾›æ–°çš„æµ‹è¯•æ—¥å¿—ï¼

## ğŸ“± è·å–æ¥æ”¶æ–¹æ§åˆ¶å°æ—¥å¿—çš„æ­¥éª¤

### æ–¹æ³•1ï¼šé€šè¿‡å¾®ä¿¡å¼€å‘è€…å·¥å…·è·å–çœŸæœºæ—¥å¿—

**æ¥æ”¶æ–¹è®¾å¤‡æ“ä½œï¼š**

1. **æ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·**
2. **é€‰æ‹©"çœŸæœºè°ƒè¯•"**
3. **æ‰«æäºŒç»´ç è¿æ¥æ¥æ”¶æ–¹æ‰‹æœº**
4. **åœ¨æ¥æ”¶æ–¹æ‰‹æœºä¸Šæ“ä½œ**ï¼š
   - ç‚¹å‡»åˆ†äº«é“¾æ¥
   - è¿›å…¥èŠå¤©é¡µé¢
   - æŸ¥çœ‹æ˜¯å¦æ˜¾ç¤ºæ­£ç¡®çš„æ ‡é¢˜å’Œç³»ç»Ÿæ¶ˆæ¯

5. **åœ¨å¼€å‘è€…å·¥å…·ä¸­æŸ¥çœ‹æ—¥å¿—**ï¼š
   - ç‚¹å‡»"æ§åˆ¶å°"é€‰é¡¹å¡
   - å¤åˆ¶æ‰€æœ‰ç›¸å…³æ—¥å¿—ä¿¡æ¯

### æ–¹æ³•2ï¼šå¦‚æœçœŸæœºè°ƒè¯•æ—¥å¿—ä¸æ¸…æ™°

**åœ¨æ¥æ”¶æ–¹æ‰‹æœºçš„èŠå¤©é¡µé¢ä¸­ï¼š**

1. **é•¿æŒ‰é¡µé¢ç©ºç™½å¤„** æˆ– **ä¸‹æ‹‰é¡µé¢**
2. **é€‰æ‹©"å¼€å¯è°ƒè¯•"** æˆ–æŸ¥çœ‹æ˜¯å¦æœ‰vConsole
3. **æˆ–è€…åœ¨èŠå¤©é¡µé¢ç›´æ¥æ£€æŸ¥ä»¥ä¸‹å†…å®¹**ï¼š
   - é¡µé¢æ ‡é¢˜æ˜¯å¦æ˜¾ç¤º"æˆ‘å’Œå‘å†¬(2)"
   - æ˜¯å¦æœ‰ç°è‰²çš„ç³»ç»Ÿæ¶ˆæ¯æ°”æ³¡
   - å¤´åƒæ˜¯å¦æ­£ç¡®æ˜¾ç¤º

## ğŸ” éœ€è¦é‡ç‚¹å…³æ³¨çš„æ—¥å¿—ä¿¡æ¯

**è¯·ç‰¹åˆ«ç•™æ„æ¥æ”¶æ–¹æ—¥å¿—ä¸­çš„è¿™äº›å…³é”®è¯ï¼š**

- `[é‚€è¯·æµç¨‹]` - é‚€è¯·åŠ å…¥è¿‡ç¨‹
- `joinByInvite` - äº‘å‡½æ•°è°ƒç”¨
- `ğŸ·ï¸` - æ ‡é¢˜æ›´æ–°è¿‡ç¨‹  
- `ğŸ‘¥` - å‚ä¸è€…ä¿¡æ¯
- `ğŸ“` - ç³»ç»Ÿæ¶ˆæ¯æ·»åŠ 
- `updateDynamicTitleWithRealNames` - æ˜µç§°æ›´æ–°

## ğŸ“‹ ä¸´æ—¶è¯Šæ–­æ–¹æ³•

**å¦‚æœæ— æ³•è·å–è¯¦ç»†æ—¥å¿—ï¼Œè¯·åœ¨æ¥æ”¶æ–¹æ‰‹æœºä¸Šï¼š**

1. **æŸ¥çœ‹é¡µé¢æ ‡é¢˜**ï¼š
   - æ˜¯å¦æ˜¾ç¤º"æˆ‘å’Œå‘å†¬(2)"ï¼Ÿ
   - è¿˜æ˜¯æ˜¾ç¤º"æˆ‘å’Œç”¨æˆ·(2)"ï¼Ÿ

2. **æŸ¥çœ‹ç³»ç»Ÿæ¶ˆæ¯**ï¼š
   - æ˜¯å¦æœ‰"æˆåŠŸåŠ å…¥å‘å†¬çš„èŠå¤©ï¼"çš„ç°è‰²æ°”æ³¡ï¼Ÿ
   - ç³»ç»Ÿæ¶ˆæ¯æ˜¯å¦å±…ä¸­æ˜¾ç¤ºï¼Ÿ

3. **æŸ¥çœ‹å¤´åƒ**ï¼š
   - è‡ªå·±å’Œå¯¹æ–¹çš„å¤´åƒæ˜¯å¦æ­£ç¡®æ˜¾ç¤ºï¼Ÿ

4. **å‘é€æµ‹è¯•æ¶ˆæ¯**ï¼š
   - æ¥æ”¶æ–¹å‘é€ä¸€æ¡æ¶ˆæ¯
   - å‘é€æ–¹èƒ½å¦æ”¶åˆ°ï¼Ÿ

## ğŸš€ å¿«é€Ÿæ£€æŸ¥å‘½ä»¤

**å¦‚æœå¯ä»¥åœ¨æ¥æ”¶æ–¹è®¾å¤‡ä¸Šæ‰“å¼€æ§åˆ¶å°ï¼Œæ‰§è¡Œï¼š**

```javascript
// æ£€æŸ¥æ¥æ”¶æ–¹çŠ¶æ€
var page = getCurrentPages()[getCurrentPages().length - 1];
console.log('=== æ¥æ”¶æ–¹çŠ¶æ€æ£€æŸ¥ ===');
console.log('é¡µé¢æ ‡é¢˜:', page.data.dynamicTitle);
console.log('å‚ä¸è€…æ•°é‡:', page.data.participants?.length);
console.log('å‚ä¸è€…ä¿¡æ¯:', page.data.participants);
console.log('ç”¨æˆ·ä¿¡æ¯:', getApp().globalData.userInfo);
console.log('ç³»ç»Ÿæ¶ˆæ¯:', page.data.messages?.filter(m => m.isSystem));
```

**è¯·æŒ‰ä»¥ä¸Šä»»ä¸€æ–¹æ³•è·å–æ¥æ”¶æ–¹ä¿¡æ¯ï¼Œç„¶åå‘Šè¯‰æˆ‘ï¼š**
1. æ¥æ”¶æ–¹çš„æ§åˆ¶å°æ—¥å¿—ï¼ˆå¦‚æœèƒ½è·å–ï¼‰
2. æˆ–è€…æ¥æ”¶æ–¹é¡µé¢çš„å®é™…æ˜¾ç¤ºæ•ˆæœ
3. ä¸¤å°è®¾å¤‡é—´çš„æ¶ˆæ¯æ”¶å‘æ˜¯å¦æ­£å¸¸

è¿™æ ·æˆ‘å°±èƒ½å‡†ç¡®å®šä½é—®é¢˜äº†ï¼ğŸ’ª 

## ğŸ” æ£€æŸ¥åˆ†äº«é…ç½®
const page = getCurrentPages()[getCurrentPages().length - 1];
const app = getApp();
const userInfo = app.globalData.userInfo;
const chatId = page.data.contactId;

console.log('=== åˆ†äº«é“¾æ¥è°ƒè¯• ===');
console.log('èŠå¤©ID:', chatId);
console.log('ç”¨æˆ·æ˜µç§°:', userInfo.nickName);
console.log('ç”¨æˆ·openId:', userInfo.openId);

// æµ‹è¯•åˆ†äº«é“¾æ¥ç”Ÿæˆ
const nickName = userInfo.nickName || 'å¥½å‹';
const sharePath = `/app/pages/chat/chat?id=${chatId}&inviter=${encodeURIComponent(nickName)}&fromInvite=true`;
console.log('å®Œæ•´åˆ†äº«é“¾æ¥:', sharePath);

// æµ‹è¯•å³ä¸Šè§’åˆ†äº«
page.onShareAppMessage(); 